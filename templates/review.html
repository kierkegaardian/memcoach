{% extends "base.html" %}

{% block title %}Review {{ deck.name }} for {{ kid.name }} - MemCoach{% endblock %}

{% block extra_head %}
<style>
    .prompt-large {
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.4;
        margin-bottom: 1rem;
        color: #1e40af;
    }
    .recall-textarea {
        font-size: 1.2rem;
        line-height: 1.5;
        border: 2px solid #e5e7eb;
        transition: border-color 0.2s;
    }
    .recall-textarea:focus {
        border-color: #3b82f6;
        outline: none;
    }
</style>
{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <h2 class="text-3xl font-bold mb-6">Review Session: {{ deck.name }} for {{ kid.name }}</h2>
    <div class="flex items-center gap-2 mb-4 text-sm text-gray-600">
        <input type="checkbox" id="group-texts-toggle" class="h-4 w-4" {% if group_texts %}checked{% endif %}>
        <label for="group-texts-toggle">Keep chunks grouped by parent text</label>
    </div>
    <div id="result"></div>
    <div id="card-container">
        {% if card %}
            {% include "partials/card.html" %}
        {% else %}
            {% include "partials/no_cards.html" %}
        {% endif %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Optional kid-friendly sound or animation on submit
    document.body.addEventListener('htmx:afterRequest', function(e) {
        if (e.detail.xhr.status === 200) {
            // Play success sound or confetti if bonus
            console.log('Card reviewed!');
        }
    });
    const groupToggle = document.getElementById('group-texts-toggle');
    if (groupToggle) {
        groupToggle.addEventListener('change', function() {
            const url = new URL(window.location.href);
            url.searchParams.set('group_texts', groupToggle.checked ? 'true' : 'false');
            window.location.href = url.toString();
        });
    }
</script>
{% endblock %}
