{% extends "base.html" %}

{% block title %}Today's Queue for {{ kid.name }} - MemCoach{% endblock %}

{% block extra_head %}
<style>
    .prompt-large {
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.4;
        margin-bottom: 1rem;
        color: #1e40af;
    }
    .recall-textarea {
        font-size: 1.2rem;
        line-height: 1.5;
        border: 2px solid #e5e7eb;
        transition: border-color 0.2s;
    }
    .recall-textarea:focus {
        border-color: #3b82f6;
        outline: none;
    }
</style>
{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto space-y-6">
    <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
        <div>
            <h2 class="text-3xl font-bold">Today's Queue for {{ kid.name }}</h2>
            <p class="text-gray-600">Review across assigned decks with caps and schedule.</p>
        </div>
        <a href="/kids/{{ kid_id }}/decks" class="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600">Back to Decks</a>
    </div>

    <div class="bg-white border rounded-lg p-4 shadow-sm">
        <div class="flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
            <p class="text-lg font-semibold text-gray-800">{{ total_due }} cards due today</p>
            <p class="text-sm text-gray-500">Avg pace: {{ avg_duration }}s/card â€¢ Est. time: {{ estimated_seconds // 60 }}m {{ estimated_seconds % 60 }}s</p>
        </div>
    </div>

    <div id="today-queue">
        {% include "partials/today_queue.html" %}
    </div>

    <div class="bg-white border rounded-lg p-4 shadow-sm">
        <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
            <div>
                <h3 class="text-xl font-semibold">Start a session</h3>
                <p class="text-sm text-gray-500">Run through today's due cards across all assigned decks.</p>
            </div>
            <button
                {% if total_due == 0 %}disabled{% endif %}
                hx-get="/today/{{ kid_id }}/next"
                hx-target="#today-card"
                hx-swap="innerHTML"
                class="bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed"
            >
                Start Session
            </button>
        </div>
    </div>

    <div id="today-result"></div>
    <div id="today-card"></div>
</div>
{% endblock %}
