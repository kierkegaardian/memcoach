<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}MemCoach - Local-First Memorization{% endblock %}</title>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{{ url_for('static', path='style.css') }}">
    {% block extra_head %}{% endblock %}
</head>
<body class="bg-gray-50 min-h-screen">
    <nav class="bg-blue-600 text-white shadow-lg">
        <div class="container mx-auto p-4 flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
            <div>
                <h1 class="text-2xl font-bold">MemCoach</h1>
                <p class="text-blue-100">Helping kids memorize with spaced repetition</p>
            </div>
            <div class="flex flex-wrap items-center gap-3">
                <a href="/kid-mode" class="bg-blue-500 hover:bg-blue-400 text-white font-semibold px-4 py-2 rounded-md">Kid Mode</a>
                {% if request.state.parent_pin_configured %}
                    {% if request.state.parent_unlocked %}
                        <a href="/kids" class="bg-blue-500 hover:bg-blue-400 text-white font-semibold px-4 py-2 rounded-md">Kids</a>
                        <a href="/kids/new" class="bg-blue-500 hover:bg-blue-400 text-white font-semibold px-4 py-2 rounded-md">Add Kid</a>
                        <a href="/admin/backup/manage" class="bg-blue-500 hover:bg-blue-400 text-white font-semibold px-4 py-2 rounded-md">Parent Admin</a>
                        <a href="/trash" class="bg-blue-500 hover:bg-blue-400 text-white font-semibold px-4 py-2 rounded-md">Trash</a>
                        <form method="post" action="/parent/lock" class="inline">
                            <input type="hidden" name="next_path" value="{{ request.url.path }}">
                            <button type="submit" class="bg-blue-500 hover:bg-blue-400 text-white font-semibold px-4 py-2 rounded-md">Lock Parent Mode</button>
                        </form>
                    {% else %}
                        <form method="post" action="/parent/unlock" class="flex flex-wrap gap-2 items-center bg-blue-500/20 px-3 py-2 rounded-md">
                            <input type="hidden" name="next_path" value="{{ request.url.path }}">
                            <label for="parent-pin" class="sr-only">Parent PIN</label>
                            <input id="parent-pin" name="pin" type="password" inputmode="numeric" autocomplete="off" placeholder="Parent PIN" class="rounded px-3 py-1 text-gray-900 text-sm" required>
                            <button type="submit" class="bg-blue-500 hover:bg-blue-400 text-white font-semibold px-3 py-1 rounded-md">Unlock</button>
                        </form>
                    {% endif %}
                {% else %}
                    <a href="/parent/setup" class="bg-blue-500 hover:bg-blue-400 text-white font-semibold px-4 py-2 rounded-md">Set Parent PIN</a>
                {% endif %}
            </div>
        </div>
    </nav>
    <main class="container mx-auto p-6">
        {% block content %}{% endblock %}
    </main>
    {% block scripts %}{% endblock %}
</body>
</html>
