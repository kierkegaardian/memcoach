{% extends "base.html" %}

{% block title %}Add Cards to {{ deck.name }} - MemCoach{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <h2 class="text-3xl font-bold mb-6">Add Cards to {{ deck.name }}</h2>
    <form method="post" enctype="multipart/form-data" class="space-y-6 bg-white p-6 rounded-lg shadow-md">
        {% if kid_id %}
            <input type="hidden" name="kid_id" value="{{ kid_id }}">
        {% endif %}
        <fieldset class="border p-4 rounded">
            <legend class="text-lg font-medium mb-2">Manual Single Card</legend>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="prompt" class="block text-sm font-medium text-gray-700 mb-1">Prompt (what the child sees)</label>
                    <input type="text" id="prompt" name="prompt" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-500" placeholder="e.g., Recite John 3:16">
                </div>
                <div>
                    <label for="full_text" class="block text-sm font-medium text-gray-700 mb-1">Full Text to Memorize</label>
                    <textarea id="full_text" name="full_text" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-500 h-24" placeholder="The exact text..."></textarea>
                </div>
            </div>
        </fieldset>
        <fieldset class="border p-4 rounded">
            <legend class="text-lg font-medium mb-2">Long Text (Auto-Chunked)</legend>
            <div class="space-y-4">
                <div>
                    <label for="long_text_title" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                    <input type="text" id="long_text_title" name="long_text_title" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-500" placeholder="e.g., Psalm 23">
                </div>
                <div>
                    <label for="long_text_body" class="block text-sm font-medium text-gray-700 mb-1">Full Text</label>
                    <textarea id="long_text_body" name="long_text_body" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:border-blue-500 h-32" placeholder="Paste the full passage here..."></textarea>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="chunk_strategy" class="block text-sm font-medium text-gray-700 mb-1">Chunking Strategy</label>
                        <select id="chunk_strategy" name="chunk_strategy" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm">
                            <option value="lines">Lines</option>
                            <option value="sentences">Sentences</option>
                            <option value="stanzas">Stanza Breaks</option>
                            <option value="custom">Custom Delimiter</option>
                        </select>
                    </div>
                    <div>
                        <label for="chunk_delimiter" class="block text-sm font-medium text-gray-700 mb-1">Custom Delimiter</label>
                        <input type="text" id="chunk_delimiter" name="chunk_delimiter" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm" placeholder="e.g., ###">
                        <p class="text-sm text-gray-500 mt-1">Used only when the strategy is custom.</p>
                    </div>
                </div>
            </div>
        </fieldset>
        <fieldset class="border p-4 rounded">
            <legend class="text-lg font-medium mb-2">Upload TXT File for Multiple Cards</legend>
            <div class="space-y-3">
                <input type="file" name="file" accept=".txt" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm">
                <label for="prompt_base" class="block text-sm font-medium text-gray-700">Prompt Base</label>
                <input type="text" id="prompt_base" name="prompt_base" value="Recite: " class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm" placeholder="Prefix for each card (e.g., 'Verse ')">
                <p class="text-sm text-gray-500">TXT file split on blank lines into cards. Prompt = base + line num if multiple lines. Manual fields ignored if file uploaded.</p>
            </div>
        </fieldset>
        <div class="flex space-x-3">
            <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-6 rounded-md transition">Add Cards</button>
            {% if kid_id %}
                <a href="/kids/{{ kid_id }}/decks" class="bg-gray-500 hover:bg-gray-600 text-white font-medium py-2 px-6 rounded-md transition">Back to Decks</a>
            {% else %}
                <a href="/decks" class="bg-gray-500 hover:bg-gray-600 text-white font-medium py-2 px-6 rounded-md transition">Back to Decks</a>
            {% endif %}
        </div>
    </form>
</div>
{% endblock %}
