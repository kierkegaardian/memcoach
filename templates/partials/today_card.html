<div class="bg-white p-6 rounded-lg shadow-md mb-6">
    <div class="flex items-center justify-between mb-2">
        <div class="prompt-large">{{ card.prompt }}</div>
        <span class="text-xs uppercase tracking-wide text-gray-500">{{ card.deck_name }}</span>
    </div>
    {% if card.text_id and card.chunk_index and card.text_total %}
        <p class="text-sm text-gray-600 mb-2">Part {{ card.chunk_index }} of {{ card.text_total }}{% if card.text_title %} â€¢ {{ card.text_title }}{% endif %}</p>
    {% endif %}
    {% if card.tags %}
        <div class="flex flex-wrap gap-2 mb-4">
            {% for tag in card.tags %}
                <span class="text-xs font-semibold uppercase tracking-wide px-2 py-1 rounded bg-slate-100 text-slate-700">{{ tag }}</span>
            {% endfor %}
        </div>
    {% endif %}
    <form
        hx-post="/today/{{ kid_id }}/submit?deck_id={{ card.deck_id }}&card_id={{ card.id }}"
        hx-target="#today-result"
        hx-swap="beforeend"
        class="space-y-4"
    >
        <input type="hidden" name="started_at" value="{{ started_at }}">
        <div>
            <label for="hint_mode" class="block text-sm font-semibold text-gray-700 mb-2">Hint mode</label>
            <select
                id="hint_mode"
                name="hint_mode"
                class="w-full border border-gray-300 rounded-lg p-2"
                hx-get="/review/hint?card_id={{ card.id }}"
                hx-trigger="change"
                hx-target="#hint-text"
                hx-swap="innerHTML"
            >
                {% for mode_value, mode_label in hint_modes %}
                    <option value="{{ mode_value }}" {% if hint_mode == mode_value %}selected{% endif %}>{{ mode_label }}</option>
                {% endfor %}
            </select>
        </div>
        <div id="hint-text" class="bg-blue-50 border border-blue-200 rounded-lg p-3 text-blue-900 whitespace-pre-wrap">
            {% if hint_text %}
                {{ hint_text }}
            {% else %}
                No hint is shown for this card.
            {% endif %}
        </div>
        <textarea name="user_text" placeholder="Type what you remember from memory..." class="recall-textarea w-full h-40 p-4" required autocomplete="off"></textarea>
        <button type="submit" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-8 rounded-lg text-lg transition w-full">I'm Done - Check My Recall!</button>
    </form>
</div>
